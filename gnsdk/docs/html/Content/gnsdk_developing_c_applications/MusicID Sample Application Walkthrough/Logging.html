<!DOCTYPE html>
<html xmlns:MadCap="http://www.madcapsoftware.com/Schemas/MadCap.xsd" lang="en-us" xml:lang="en-us" class="no-feedback" data-mc-search-type="Stem" data-mc-help-system-file-name="index.xml" data-mc-path-to-help-system="../../../" data-mc-target-type="WebHelp2" data-mc-runtime-file-type="Topic" data-mc-preload-images="false" data-mc-in-preview-mode="false" data-mc-toc-path="Developer's Guide|Getting Started|Using the Sample Applications|MusicID Sample Application Walkthrough">
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><title>Logging</title>
        <link href="../../../Skins/Default/Stylesheets/TextEffects.css" rel="stylesheet" />
        <link href="../../../Skins/Default/Stylesheets/Topic.css" rel="stylesheet" />
        <link href="../../Resources/Stylesheets/BookStyles.css" rel="stylesheet" />
        <script src="../../../Resources/Scripts/jquery.min.js">
        </script>
        <script src="../../../Resources/Scripts/plugins.min.js">
        </script>
        <script src="../../../Resources/Scripts/MadCapAll.js">
        </script>
    </head>
    <body>
        <div class="MCBreadcrumbsBox_0"><span class="MCBreadcrumbsPrefix">You are here: </span><span class="MCBreadcrumbsSelf">Developer's Guide</span><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Getting Started.html">Getting Started</a><span class="MCBreadcrumbsDivider"> &gt; </span><a class="MCBreadcrumbsLink" href="../Using the Sample Applications.html">Using the Sample Applications</a><span class="MCBreadcrumbsDivider"> &gt; </span><span class="MCBreadcrumbs">Logging</span>
        </div>
        <h1 class="Heading1">Logging</h1>
        <p><strong>Note</strong>: The sample application has changed and no longer logs errors to a file. Now, it simply uses printfs to write them to the console. However, this topic has been left unchanged, to show how logging using GNSDK calls can be done.</p>
        <p>The _init_gnsdk() function calls _enable_logging(), which makes the following <span class="GNVariablesProductName">GNSDK</span> logging call:</p><pre xml:space="preserve">gnsdk_manager_logging_enable(<br />&#160; "sample.log",&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Log file path <br />&#160; GNSDK_LOG_PKG_ALL,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Include entries for all packages and subsystems <br />&#160; GNSDK_LOG_LEVEL_ERROR|GNSDK_LOG_LEVEL_WARNING,// Include only error and warning entries<br />&#160; GNSDK_LOG_OPTION_ALL,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // All logging options: timestamps, thread IDs, etc<br />&#160; 0,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Max size of log: 0 means a new log file will be created each run<br />&#160; GNSDK_FALSE&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // GNSDK_TRUE = old logs will be renamed and saved<br />);</pre>
        <p>As can be seen, your application has a number of logging options. The <span class="GNVariablesProductName">GNSDK</span> logging system can manage multiple logs at the same time. Each call to this API can enable a new log, if the new log's provided file name is unique. Additionally, each log can have its own filters and options.</p>
        <p>The most typical use case for <span class="GNVariablesProductName">GNSDK</span> logging is to configure a single log file to capture all logged messages and errors. You can control the detail level of the run time logs to include specific information (such as logging only errors or full debug information).</p>
        <p>However, you can also direct the <span class="GNVariablesProductName">GNSDK</span> to allow a logging callback, where you can determine how best to capture and disseminate specific logged messages. For example, your callback function could write to its own log files or pass the messages to an external logging framework, such as the Unix Syslog or the Windows Event Log.</p>
        <p>The <span class="GNVariablesProductName">GNSDK</span> logging system writes log messages to all appropriate enabled logs, as applicable. This includes scenarios where filters have overlapping functionality; in this case, the logging system writes a log message to multiple logs.</p>
        <h2 class="Heading2">Error Information</h2>
        <p>This sample application has a function—_log_app_error()— for logging error messages. This gets called when the Gracenote Service returns an error (for example, Return Code != GNSDK_SUCCESS). The function first makes a call to get error information from <span class="GNVariablesProductName">GNSDK</span>:</p><pre>
const gnsdk_error_info_t* err_info = GNSDK_NULL;
err_info = gnsdk_manager_error_info();            //** Get the error info
</pre>
        <p>To retrieve any error information, your application must call this function immediately after receiving an error from a GNSDK API. Though not all APIs provide error information, at a minimum, they return an error description string.</p>
        <h2 class="Heading2">Writing to the Log File</h2>
        <p>You can use the following GNSDK API to log errors to a file:</p><pre xml:space="preserve">gnsdk_manager_logging_write(<br />&#160;&#160; line,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Source line number of this call (optional) <br />&#160;&#160; file,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Source file name of this call (optional)<br />&#160;&#160; MYAPP_PACKAGE_ID,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Package ID of application making call <br />&#160;&#160; GNSDK_LOG_LEVEL_ERROR,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Error mask for this logging message <br />&#160;&#160; "%s: 0x%x - %x. error info: %s: 0x%x - %s.", // Error message format <br />&#160;&#160; info,&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // Error message format arguments<br />&#160;&#160; error,<br />&#160;&#160; err_info-&gt;source_error_code,<br />&#160;&#160; err_info-&gt;error_description,<br />&#160;&#160; err_info-&gt;error_code,<br />&#160;&#160; err_info-&gt;error_api<br />);</pre>
        <p>Log entries are identified by the 'package' that logs them using a self-defined package ID, for example:</p><pre xml:space="preserve">#define MYAPP_PACKAGE_ID&#160;&#160;&#160; GNSDKPKG_ID_APP_START+0x01</pre>
        <p>The package ID must be in the range GNSDKPKG_ID_APP_START to MAX_GNSDK_PKG_ID</p>
        <p>For more information about logging, see the API Reference documentation for gnsdk_manager_logging.h</p>
        <p>&#160;</p>
        <p class="onlineFooter">© 2000 to present. Gracenote, Inc. All rights reserved.</p>
        <p><a href="mailto:doc_feedback@gracenote.com?subject=Gracenote Documentation Feedback" target="_blank" title="Send comments about this topic to Gracenote Technical Publications." alt="Send comments about this topic to Gracenote Technical Publications.">How can we improve this documentation?</a>
        </p>
    </body>
</html>